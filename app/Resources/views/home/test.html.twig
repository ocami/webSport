{% extends 'form_layout.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretty-checkbox@3.0/dist/pretty-checkbox.min.css"/>
    <link rel="stylesheet" href="{{ asset('css/multi-switch.min.css') }}"/>

    <style>

        .no-padding > [class*='col-'] {
            max-height: 1em;
        }

        .switchContainer {
            padding-top: 0.2em;
        }

        #search-bar {
            margin-top: 4em;
        }

        #search-bar .panel-heading {
            height: 1.5em;
            padding: 0em;
        }

        .dep-container {
            padding: 1em 0em 0em 0.5em;
        }

        .cb-heading {
            z-index: 100;
        }




    </style>

{% endblock %}

{% block title %}
    {{ parent() }} Recherche courses
{% endblock %}

{% block body %}

    <div class="col-xs-3">
        {% include 'race/widget/searchBar.html.twig' %}
    </div>
    <div class="col-xs-9">
        <div class="row">
            {% for race in races %}
                <div class="col-xs-12 col-sm-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <span class="panel-title">{{ race.name }} </span>
                            <span class="pull-right">
                        {% if race.inChampionship %}
                            <img src="{{ asset('img/cup.jpg') }}" class="img-circle">
                        {% endif %}

                                {% if race.valid %}
                                    {{ race.competitorRegister|registerImg }}
                                {% endif %}
                    </span>
                        </div>
                        <div class="panel-body panel-body-race">

                            <h4 style="text-align: center">{{ race.dateTime|localizeddate('none', 'none', 'fr_BR', null, "cccc d MMMM") }}</h4>

                            <div class="row">
                                <div class="col-xs-8 col-lg-7 race-description">
                                    <span class="col-xs-7">Départ :</span><span class="col-xs-5"> {{ race.dateTime|date('H') }}
                                        H {{ race.dateTime|date('i') }}</span>
                                    <span class="col-xs-7">Distance :</span><span class="col-xs-5"> {{ race.distance }}
                                        Km</span>
                                </div>

                                <div class="col-xs-4">
                                    {% if race.fullCat %}
                                        <div class="category">
                                            Toute catégories
                                        </div>
                                    {% else %}
                                        <div class="categories">
                                            {% for category in race.categories %}
                                                <span style="margin-left: 1em">{{ category.name }}</span><br>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer">
                            <input type="button" class="btn-xs btn-info" value="Détail"
                                   onclick="location.href = '{{ path('race_show', {'id': race.id}) }}';">

                            {% if is_granted('ROLE_COMPETITOR') %}
                                {% if race.valid %}
                                    {% if race.competitorRegister == 1 %}
                                        <input type="button" class="btn-xs btn-info" value="S'inscrire"
                                               onclick="location.href = '{{ path('app_competitor_addrace', {'race': race.id}) }}';">
                                    {% endif %}
                                    {% if race.competitorRegister == 2 %}
                                        <input type="button" class="btn-xs btn-info" value="Annuler"
                                               onclick="location.href = '{{ path('app_competitor_removerace', {'race': race.id}) }}';">
                                    {% endif %}
                                {% endif %}
                            {% endif %}

                            {% if race.isOrganizer == true %}
                                <input type="button" class="btn-xs btn-success" value="Editer"
                                       onclick="location.href = '{{ path('race_edit', {'id': race.id}) }}';">

                                {% if race.supervised %}
                                    {{ race.competition.valid|validImg }}
                                {% else %}
                                    <img src="{{ asset('img/question.png ') }}" class="img-circle pull-right">
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}

    {% block javascripts %}
        {{ parent() }}
        <script>

            searchBarRace();
        </script>
    {% endblock %}